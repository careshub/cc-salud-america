(function(n){"use strict";function o(t){n("#"+t+" .working-indicator").addClass("ajax-loading");i.ajax.send("cc_sa_get_recent_items",{success:s,error:function(){return""},data:{advo_target:t,exclude_ids:n("#sa-recent-items-exclude-ids").val()}})}function s(t){var i=n("#sa-recent-items-exclude-ids").val().split(",");n.each(t.posts,function(t,r){n(".recent-item-cell."+t+" .entry-footer").before(f(r));i.push(r.post_id)});u(t.term_slug);n("#sa-recent-items-exclude-ids").val(i.toString())}function u(t){n(".recent-item-cell .entry-content").filter(":visible").fadeOut("fast",function(){n(".recent-item-cell .entry-content."+t).fadeIn("fast")});n("#"+t+" .working-indicator.ajax-loading").removeClass("ajax-loading");n(".topic-selector a.active").removeClass("active");n(".topic-selector a#"+t).addClass("active")}function h(){n.ajax({url:"/wp-json/wp/v2/sa_ticker_items?filter[posts_per_page]=6",cache:!1}).done(function(t){n.each(t,function(t,i){n("#sa-ticker-marquee").append(e(i))});n(".sa-ticker-placeholder").slideUp(function(){n(this).remove()});setInterval(function(){c()},5e3)})}function c(){n("#sa-ticker-marquee").hasClass("pause-ticker")||n("#sa-ticker-marquee li:first").slideUp(function(){n(this).appendTo(n("#sa-ticker-marquee")).slideDown()})}var i=window.wp,f=i.template("salud-recent-items-block"),e=i.template("salud-ticker-items-block"),r=!1,t="";n(function(){var v,e,c,l,i;if(window.sa=window.sa||{},typeof base_map_widget_src!="undefined"){var f=jQuery("#map-widget-container").width(),s=240,a="";f=Math.round(f);jQuery(window).width()>599&&jQuery("#sa-join-group-action-call").height()?s=jQuery("#sa-join-group-action-call").height():f>500&&(s=Math.round(f*2/3));a="&w="+f+"&h="+s;v=document.getElementById("map-widget-container");document._write||(document._write=document.write);document.write=function(n){v.innerHTML+=n};jQuery.ajax({url:base_map_widget_src+a,dataType:"script",cache:!0,crossDomain:!0}).success(function(){})}n("#topic-toggle").on("click","a.toggle",function(i){(i.preventDefault(),r===!1)&&(r=!0,t=n(this).attr("id"),n(".recent-item-cell .entry-content."+t).length?u(t):o(t),r=!1)});n("#salud-search-advanced").length&&(n('input[name="type[]"]:checked').length||n('input[name="topic[]"]:checked').length||n("#salud-search-advanced").hide());n("#toggle-advanced-search").click(function(t){t.preventDefault();n("#salud-search-advanced").toggle()});n("#salud-advanced-hub-search-submit").click(function(t){t.preventDefault();var i="",r=1;n('input[name="type[]"]:checked').each(function(){r>1&&(i+=",");i+=n(this).val();r++});i?n("#salud-hub-advanced-search #type").val(i):n("#salud-hub-advanced-search #type").prop("disabled",!0);i="";r=1;n('input[name="topic[]"]:checked').each(function(){r>1&&(i+=",");i+=n(this).val();r++});i?n("#salud-hub-advanced-search #topic").val(i):n("#salud-hub-advanced-search #topic").prop("disabled",!0);n("#salud-hub-advanced-search").submit()});n("#sa-ticker-marquee").length&&(h(),n("#sa-ticker-marquee").hover(function(){n(this).addClass("pause-ticker")},function(){n(this).removeClass("pause-ticker")}));n("#video-contest-rules .rules").toggle();n("#video-contest-rules .toggle").on("click",function(t){t.preventDefault();n("#video-contest-rules .rules").slideToggle("fast")});n(".video-container-group.bilingual-video").each(function(){n(this).find(".video-in-english").length&&n(this).find(".video-in-spanish").hide()});n(".show-english-video, .show-spanish-video").on("click",function(){n(this).parents(".bilingual-video").find(".video-in-spanish, .video-in-english").toggle()});e="http://services.communitycommons.org/";c=function(t,i){n.ajax({type:"get",url:e+"api-location/v1/geoid-list/"+t,dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,success:i,error:function(n){console.log(n)}})};n("#state-list").length?c("040",function(t){n.each(t,function(t,i){var r=i.geoid.substr(i.geoid.length-2);parseInt(r)<60&&n("#state-list").append(n("<option><\/option>").val(i.geoid).html(i.name))})}):(l=n("#report-card-geoid").length?n("#report-card-geoid").val():"",l!==""&&_kmq.push(["record","opened a salud report card",{geoid:l}]));n("#state-list").on("change",function(){var t=n("#state-list option:selected").text();c("050?state="+t,function(t){n("#county-list").show();n("#county-list option").each(function(){n(this).val()!==""&&n(this).remove()});n.each(t,function(t,i){n("#county-list").append(n("<option><\/option>").val(i.geoid).html(i.name))})})});n("#county-list").on("change",function(){var t=n("#county-list").val();t!==""&&(n("#report-wait-message").show(),document.location=document.location.href.split("?")[0]+"?geoid="+t)});n(".sa-report-export").on("click",function(){var h="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext",r=function(n){var t="<link type='text/css' rel='stylesheet' href='"+h+"' />";t+="<div style='font-family: Open Sans, Helvetica, Arial, sans-serif; text-align:center; line-height: 250%;'>";t+="<h2>"+n+"<\/h2>";t+="<\/div>";i.document.body.innerHTML=t},c=function(n,t){i.resizeTo(n,t);i.moveTo((screen.width-n)/2,(screen.height-t)/2)},u,t,o,f,l,s;typeof i!="undefined"&&i.location&&i.close();i=window.open("","newwin","width=500,height=300");r("Converting report card to Adobe PDF format. Please wait...");c(550,400);u="<!DOCTYPE html><html><head>";t=location.protocol;t+="//"+document.location.hostname+"/";n.each([h,t+"wp-content/themes/twentytwelve/style.css",t+"wp-content/themes/CommonsRetheme/style.css",t+"wp-content/plugins/cc-salud-america/public/css/sa-report-card.css"],function(n,t){u+="<link type='text/css' rel='stylesheet' href='"+t+"' />"});o="sa-report-content";f=n("#"+o).html();f=f.replace(/src=("|')\//g,'src="'+t);u+="<\/head><body class='custom-font-enabled'><div id='"+o+"'>"+f+"<\/div><\/body><\/html>";l={content:u,pdf:{file_name:"SaludReportCard",show_pagenumber:!0,is_landscape:!1,page_width:770,logo_list:[e+"assets/images/logo-salud.png",e+"assets/images/logo-rwjf.png"]}};s="Conversion to PDF failed. Please try again or contact us.";n.ajax({type:"POST",url:e+"api-converter/v1/htm2pdf/content",dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,data:JSON.stringify(l),success:function(n){n?(r("Loading PDF File..."),i.location=n,c(1e3,screen.height)):r(s)},error:function(n){console.log(n);r(s)}});_kmq.push(["record","exported a salud report card to pdf",{geoid:n("#report-card-geoid").val(),county:n("#report-card-county").val(),state:n("#report-card-state").val()}])});n(".sa-report-save").on("click",function(){n(".report-save-message").show();var t=n("#report-card-geoid").val(),i=n("#report-card-county").val(),r=n("#report-card-state").val();n.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:{action:"save-leader-report-as-doc",geoid:t,county:i,state:r,_wpnonce:n("#report-card-wpnonce").val()},success:function(){n(".report-save-message").html("This report card has been saved to your personal library.");n(".sa-report-save").hide()},error:function(){n(".report-save-message").html("Unable to save this report card.")}});_kmq.push(["record","saved a salud report card to library",{geoid:t,county:i,state:r}])})})})(jQuery);
//# sourceMappingURL=public.min.js.map
