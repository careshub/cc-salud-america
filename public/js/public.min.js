/*! ccSA - v1.8.3 - 2016-10-07 */!function(a){"use strict";function b(b){a("#"+b+" .working-indicator").addClass("ajax-loading"),g.ajax.send("cc_sa_get_recent_items",{success:c,error:function(){return""},data:{advo_target:b,exclude_ids:a("#sa-recent-items-exclude-ids").val()}})}function c(b){var c=a("#sa-recent-items-exclude-ids").val().split(",");a.each(b.posts,function(b,d){a(".recent-item-cell."+b+" .entry-footer").before(h(d)),c.push(d.post_id)}),d(b.term_slug),a("#sa-recent-items-exclude-ids").val(c.toString())}function d(b){a(".recent-item-cell .entry-content").filter(":visible").fadeOut("fast",function(){a(".recent-item-cell .entry-content."+b).fadeIn("fast")}),a("#"+b+" .working-indicator.ajax-loading").removeClass("ajax-loading"),a(".topic-selector a.active").removeClass("active"),a(".topic-selector a#"+b).addClass("active")}function e(){a.ajax({url:"/wp-json/wp/v2/sa_ticker_items?filter[posts_per_page]=6",cache:!1}).done(function(b){a.each(b,function(b,c){a("#sa-ticker-marquee").append(i(c))}),a(".sa-ticker-placeholder").slideUp(function(){a(this).remove()}),setInterval(function(){f()},5e3)})}function f(){a("#sa-ticker-marquee").hasClass("pause-ticker")||a("#sa-ticker-marquee li:first").slideUp(function(){a(this).appendTo(a("#sa-ticker-marquee")).slideDown()})}var g=window.wp,h=g.template("salud-recent-items-block"),i=g.template("salud-ticker-items-block"),j=!1,k="";a(function(){if(window.sa=window.sa||{},"undefined"!=typeof base_map_widget_src){var c=jQuery("#map-widget-container").width(),f=240,g="";c=Math.round(c),jQuery(window).width()>599&&jQuery("#sa-join-group-action-call").height()?f=jQuery("#sa-join-group-action-call").height():c>500&&(f=Math.round(2*c/3)),g="&w="+c+"&h="+f;var h=document.getElementById("map-widget-container");document._write||(document._write=document.write),document.write=function(a){h.innerHTML+=a},jQuery.ajax({url:base_map_widget_src+g,dataType:"script",cache:!0,crossDomain:!0}).success(function(a,b,c){})}a("#topic-toggle").on("click","a.toggle",function(c){c.preventDefault(),j===!1&&(j=!0,k=a(this).attr("id"),a(".recent-item-cell .entry-content."+k).length?d(k):b(k),j=!1)}),a("#salud-search-advanced").length&&(a('input[name="type[]"]:checked').length||a('input[name="topic[]"]:checked').length||a("#salud-search-advanced").hide()),a("#toggle-advanced-search").click(function(b){b.preventDefault(),a("#salud-search-advanced").toggle()}),a("#salud-advanced-hub-search-submit").click(function(b){b.preventDefault();var c="",d=1;a('input[name="type[]"]:checked').each(function(){d>1&&(c+=","),c+=a(this).val(),d++}),c?a("#salud-hub-advanced-search #type").val(c):a("#salud-hub-advanced-search #type").prop("disabled",!0),c="",d=1,a('input[name="topic[]"]:checked').each(function(){d>1&&(c+=","),c+=a(this).val(),d++}),c?a("#salud-hub-advanced-search #topic").val(c):a("#salud-hub-advanced-search #topic").prop("disabled",!0),a("#salud-hub-advanced-search").submit()}),a("#sa-ticker-marquee").length&&(e(),a("#sa-ticker-marquee").hover(function(){a(this).addClass("pause-ticker")},function(){a(this).removeClass("pause-ticker")})),a("#video-contest-rules .rules").toggle(),a("#video-contest-rules .toggle").on("click",function(b){b.preventDefault(),a("#video-contest-rules .rules").slideToggle("fast")}),a(".video-container-group.bilingual-video").each(function(){a(this).find(".video-in-english").length&&a(this).find(".video-in-spanish").hide()}),a(".show-english-video, .show-spanish-video").on("click",function(){a(this).parents(".bilingual-video").find(".video-in-spanish, .video-in-english").toggle()});var i="http://services.communitycommons.org/",l=function(b,c){a.ajax({type:"get",url:i+"api-location/v1/geoid-list/"+b,dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,success:c,error:function(a){console.log(a)}})};if(a("#state-list").length)l("040",function(b){a.each(b,function(b,c){var d=c.geoid.substr(c.geoid.length-2);parseInt(d)<60&&a("#state-list").append(a("<option></option>").val(c.geoid).html(c.name))})});else{var m=a("#report-card-geoid").length?a("#report-card-geoid").val():"";""!==m&&_kmq.push(["record","opened a salud report card",{geoid:m}]),a.each([".big-bet-icon-link",".learn-more-link",".salud-report-card-link"],function(b,c){a(c).on("click",function(){_kmq.push(["record","clicked link on salud report card: "+a(this).attr("title"),{geoid:m}])})})}a("#state-list").on("change",function(){var b=a("#state-list option:selected").text();l("050?state="+b,function(b){a("#county-list").show(),a("#county-list option").each(function(){""!==a(this).val()&&a(this).remove()}),a.each(b,function(b,c){a("#county-list").append(a("<option></option>").val(c.geoid).html(c.name))})})}),a("#county-list").on("change",function(){var b=a("#county-list").val();""!==b&&(a("#report-wait-message").show(),document.location=document.location.href.split("?")[0]+"?geoid="+b)});var n;a(".sa-report-export").on("click",function(){var b="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext",c=function(a){var c="<link type='text/css' rel='stylesheet' href='"+b+"' />";c+="<div style='font-family: Open Sans, Helvetica, Arial, sans-serif; text-align:center; line-height: 250%;'>",c+="<h2>"+a+"</h2>",c+="</div>",n.document.body.innerHTML=c},d=function(a,b){n.resizeTo(a,b),n.moveTo((screen.width-a)/2,(screen.height-b)/2)};"undefined"!=typeof n&&n.location&&n.close(),n=window.open("","newwin","width=500,height=300"),c("Converting report card to Adobe PDF format. Please wait..."),d(550,400);var e="<!DOCTYPE html><html><head>";e+='<meta charset="UTF-8" />';var f=location.protocol;f+="//"+document.location.hostname+"/",a.each([b,f+"wp-content/themes/twentytwelve/style.css",f+"wp-content/themes/CommonsRetheme/style.css",f+"wp-content/plugins/cc-salud-america/public/css/sa-report-card.css"],function(a,b){e+="<link type='text/css' rel='stylesheet' href='"+b+"' />"});var g="sa-report-content";a("noscript").remove(),a("#"+g+" img").each(function(){a(this).attr("src",a(this).attr("data-lazy-src"))});var h=a("#"+g).html();h=h.replace(/src=("|')\//g,'src="'+f),e+="</head><body class='custom-font-enabled'><div id='"+g+"'>"+h+"</div></body></html>";var j={content:e,pdf:{file_name:"SaludReportCard",show_pagenumber:!0,is_landscape:!1,page_width:770,logo_list:[i+"assets/images/logo-salud.png",i+"assets/images/logo-rwjf.png"]}},k="Conversion to PDF failed. Please try again or contact us.";a.ajax({type:"POST",url:i+"api-converter/v1/htm2pdf/content",dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,data:JSON.stringify(j),success:function(a){a?(c("Loading PDF File..."),n.location=a,d(1e3,screen.height)):c(k)},error:function(a){console.log(a),c(k)}}),_kmq.push(["record","exported a salud report card to pdf",{geoid:a("#report-card-geoid").val(),county:a("#report-card-county").val(),state:a("#report-card-state").val()}])}),a(".sa-report-save").on("click",function(){a(".report-save-message").show();var b=a("#report-card-geoid").val(),c=a("#report-card-county").val(),d=a("#report-card-state").val();a.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:{action:"save-leader-report-as-doc",geoid:b,county:c,state:d,_wpnonce:a("#report-card-wpnonce").val()},success:function(b){a(".report-save-message").html("This report card has been saved to your personal library."),a(".sa-report-save").hide()},error:function(b){a(".report-save-message").html("Unable to save this report card.")}}),_kmq.push(["record","saved a salud report card to library",{geoid:b,county:c,state:d}])})})}(jQuery);